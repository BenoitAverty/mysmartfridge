<?xml version="1.0" encoding="utf-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

	<!-- Create Recipes table. -->
	<changeSet id="1" author="baverty">

		<createTable tableName="recipes">
			<column name="tid" type="bigint" autoIncrement="true">
				<constraints primaryKey="true" />
			</column>
			<column name="title" type="varchar(255)">
				<constraints nullable="false" />
			</column>
			<column name="nb_people" type="integer">
				<constraints nullable="false" />
			</column>
			<column name="prep_time" type="integer">
				<constraints nullable="false" />
			</column>
			<column name="cook_time" type="integer">
				<constraints nullable="false" />
			</column>
		</createTable>

	</changeSet>
	
	<!-- Create Steps table -->
	<changeSet id="2" author="baverty">
		<createTable tableName="steps">
			<column name="recipe_tid" type="bigint">
				<constraints primaryKey="true" references="recipes(tid)" foreignKeyName="steps_recipe_fk" />
			</column>
			<column name="index" type="int">
				<constraints primaryKey="true" />
			</column>
			<column name="text" type="CLOB">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>
	
	<!-- Create products table -->
	<changeSet id="3" author="baverty">
		<createTable tableName="products">
			<column name="tid" type="bigint">
				<constraints primaryKey="true" />
			</column>
			<column name="name" type="varchar(255)">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

	<!-- Create ingredients table -->
	<changeSet id="4" author="baverty">
		<createTable tableName="ingredients">
			<column name="recipe_tid" type="bigint">
				<constraints primaryKey="true" references="recipes(tid)" foreignKeyName="ingredients_recipe_fk" />
			</column>
			<column name="product_tid" type="bigint">
				<constraints primaryKey="true" references="products(tid)" foreignKeyName="ingredients_product_fk" />
			</column>
			<column name="quantity" type="varchar(255)">
			</column>
		</createTable>
	</changeSet>

	<!-- Create Users table -->
	<changeSet id="5" author="baverty">

		<createTable tableName="users">
			<column name="tid" type="bigint" autoIncrement="true">
				<constraints primaryKey="true" />
			</column>
			<column name="email" type="varchar(255)">
				<constraints nullable="false" unique="true" />
			</column>
			<column name="password" type="varchar(255)">
				<constraints nullable="false" />
			</column>
		</createTable>
	</changeSet>

</databaseChangeLog>
